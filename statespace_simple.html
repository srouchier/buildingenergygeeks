
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A simple RC model &#8212; Building energy probabilistic modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'statespace_simple';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The pySIP library" href="pysip.html" />
    <link rel="prev" title="Principle of SSMs" href="statespace_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Building energy probabilistic modelling - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Building energy probabilistic modelling - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Building energy probabilistic modelling
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="background.html">Motivation for probabilistic modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelling.html">Simplified building energy modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">A Bayesian data analysis workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Simple regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="linearregression.html">Linear regression (PyMC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearregression_stan.html">Linear regression (Stan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Energy signature</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Time series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="timeseries_intro.html">Time series models</a></li>
<li class="toctree-l1"><a class="reference internal" href="armax.html">ARMAX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="autocorrelated.html">Autocorrelated energy signature</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm.html">Hidden Markov models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">State-space models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="statespace_intro.html">Principle of SSMs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">A simple RC model</a></li>
<li class="toctree-l1"><a class="reference internal" href="pysip.html">The pySIP library</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/srouchier/buildingenergygeeks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/srouchier/buildingenergygeeks/issues/new?title=Issue%20on%20page%20%2Fstatespace_simple.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/statespace_simple.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A simple RC model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study">Case study</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rc-model">RC model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deterministic-formulation">Deterministic formulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-formulation">Stochastic formulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specification">Specification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics-and-residuals-analysis">Diagnostics and residuals analysis</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-simple-rc-model">
<span id="statespace-simple"></span><h1>A simple RC model<a class="headerlink" href="#a-simple-rc-model" title="Link to this heading">#</a></h1>
<p>As a practical example of linear state-space models, the simplified resistor-capacitor (RC) model structures are a popular choice for either parameter estimation or system identification. When written as a set of stochastic differential equations, they allow accounting for modelling approximations <span id="id1">[<a class="reference internal" href="references.html#id28" title="Henrik Madsen and Jan Holst. Estimation of continuous-time models for the heat dynamics of a building. Energy and buildings, 22(1):67–79, 1995.">Madsen and Holst, 1995</a>]</span> and offer a more reproducible parameter estimation than deterministic models that overlook modelling errors <span id="id2">[<a class="reference internal" href="references.html#id29" title="Simon Rouchier, Mickaël Rabouille, and Pierre Oberlé. Calibration of simplified building energy models for parameter estimation and forecasting: stochastic versus deterministic modelling. Building and Environment, 134:181–190, 2018.">Rouchier <em>et al.</em>, 2018</a>]</span>.</p>
<p>This tutorial shows an RC model being used to estimate the heat resistance and capacitance of a test house. The model will be implemented twice: the first time in a deterministic formulation, without system uncertainty; the second time in a stochastic formulation, solved by the Kalman filter.</p>
<section id="case-study">
<h2>Case study<a class="headerlink" href="#case-study" title="Link to this heading">#</a></h2>
<p>The experimental test cell used in this study is called the Armadillo Box. It is a demonstration building of 42 m<span class="math notranslate nohighlight">\(^2\)</span> floor area, designed for the 2010 European Solar Decathlon by the ENSAG-GAIA-INES team. The envelope is a light wood framed construction with integrated insulation. Heating and cooling is performed by a “3 in 1” heat pump, and photovoltaic solar panels provide recharge for electric vehicles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/statespace.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="rcexample01">
<a class="reference internal image-reference" href="_images/rcexample01.png"><img alt="_images/rcexample01.png" src="_images/rcexample01.png" style="width: 450px;" />
</a>
</figure>
<p>The building is monitored by a variety of sensors, but the present study only uses records of indoor temperature and prescribed heating power, in addition to weather data. The indoor temperature profiles used here have been averaged over several sensors distributed in the living space. The measurement time is 4 days, during which there is a 24 hour heat input.</p>
<p><em>Note from the author: I chose not to display the code that generated the figures in this page</em></p>
</section>
<section id="modelling">
<h2>Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h2>
<section id="rc-model">
<h3>RC model<a class="headerlink" href="#rc-model" title="Link to this heading">#</a></h3>
<p>Consider the example of a simple building represented by a 2-resistor, 2-capacitor model structure (2R2C), described <a class="reference internal" href="statespace_intro.html#linearssm"><span class="std std-ref">here</span></a>.</p>
<figure class="align-center" id="rcmodel2">
<a class="reference internal image-reference" href="_images/rcmodel.png"><img alt="_images/rcmodel.png" src="_images/rcmodel.png" style="width: 500px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">2R2C model</span><a class="headerlink" href="#rcmodel2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The equations of this model are:</p>
<div class="math notranslate nohighlight" id="equation-ssmexample1">
<span class="eqno">(68)<a class="headerlink" href="#equation-ssmexample1" title="Link to this equation">#</a></span>\[C_i \, \mathrm{d} T_i = \dfrac{1}{R_i}\left(T_e-T_i\right)\mathrm{d}t + \Phi_h \, \mathrm{d}t + A_i \Phi_s \mathrm{d}t + \sigma_i \,\mathrm{d}\omega_i \]</div>
<div class="math notranslate nohighlight" id="equation-ssmexample2">
<span class="eqno">(69)<a class="headerlink" href="#equation-ssmexample2" title="Link to this equation">#</a></span>\[C_e \, \mathrm{d} T_e = \dfrac{1}{R_i}\left(T_i-T_e\right)\mathrm{d}t + \frac{1}{R_o}\left(T_o-T_e\right)\mathrm{d}t + A_e \Phi_s \mathrm{d}t + \sigma_e \, \mathrm{d}\omega_e\]</div>
<p>where <span class="math notranslate nohighlight">\(T_i\)</span>, <span class="math notranslate nohighlight">\(T_e\)</span> and <span class="math notranslate nohighlight">\(T_o\)</span> are the indoor, envelope and outdoor temperatures. The envelope temperature is associated with the thermal mass of the opaque surfaces, and does not represent a specific coordinate within the envelope. The model has two states <span class="math notranslate nohighlight">\(T_e\)</span> (unobserved) and <span class="math notranslate nohighlight">\(T_i\)</span> (observed); <span class="math notranslate nohighlight">\(\Phi_h\)</span> (W) is the indoor heating power; <span class="math notranslate nohighlight">\(\Phi_s\)</span> (W/m<span class="math notranslate nohighlight">\(^2\)</span>) is the global horizontal solar irradiance. <span class="math notranslate nohighlight">\(R_i\)</span> (K/W) is the thermal resistance between the indoor air temperature and the envelope, <span class="math notranslate nohighlight">\(R_e\)</span> the resistance between the envelope and the ambient air. <span class="math notranslate nohighlight">\(C_i\)</span> and <span class="math notranslate nohighlight">\(C_e\)</span> (J/K) are the heat capacitances of the interior and the envelope, respectively, and <span class="math notranslate nohighlight">\(A_i\)</span> and <span class="math notranslate nohighlight">\(A_e\)</span> (m<span class="math notranslate nohighlight">\(^2\)</span>) are their solar gain coefficients. <span class="math notranslate nohighlight">\(\{\omega_i\}\)</span> and <span class="math notranslate nohighlight">\(\{\omega_e\}\)</span> are standard Wiener processes and <span class="math notranslate nohighlight">\(\sigma_i^2\)</span> are <span class="math notranslate nohighlight">\(\sigma_e^2\)</span> are their variances. This process noise is a way to account for modelling approximations, unrecognized inputs or noise-corrupted input measurements.</p>
<p>Despite its simplicity, this model structure is able to reproduce the thermal behaviour of a simple unoccupied building. The equations can be written in matrix form:</p>
<div class="math notranslate nohighlight" id="equation-ssmexample3">
<span class="eqno">(70)<a class="headerlink" href="#equation-ssmexample3" title="Link to this equation">#</a></span>\[\begin{split}\mathrm{d} \begin{bmatrix} T_i \\ T_e \end{bmatrix} = \begin{pmatrix} -\frac{1}{R_i \, C_i} &amp; \frac{1}{R_i \, C_i} \\ \frac{1}{R_i \, C_e} &amp; -\frac{1}{R_i \, C_e}-\frac{1}{R_e \, C_e}\end{pmatrix} \begin{bmatrix} T_i \\ T_e \end{bmatrix}\, \mathrm{d}t + \begin{pmatrix} 0 &amp; \frac{1}{C_i} &amp; \frac{A_i}{C_i} \\ \frac{1}{R_o \, C_e} &amp; 0 &amp; \frac{A_e}{C_e} \end{pmatrix} \begin{bmatrix} T_o \\ \Phi_h \\ \Phi_s \end{bmatrix} \, \mathrm{d}t + \mathbf{\sigma} \, \mathrm{d}\omega\end{split}\]</div>
<p>which is the dynamic model of the following stochastic state-space model, written in continuous-discrete form:</p>
<div class="math notranslate nohighlight" id="equation-ssmexample4">
<span class="eqno">(71)<a class="headerlink" href="#equation-ssmexample4" title="Link to this equation">#</a></span>\[\mathrm{d}\mathbf{x}(t) = \mathbf{A}_\mathit{rc} \, \mathbf{x}(t) \, \mathrm{d}t + \mathbf{B}_\mathit{rc} \, \mathbf{u}(t)\,\mathrm{d}t + \mathbf{\sigma}_\theta \mathrm{d}\omega \]</div>
<div class="math notranslate nohighlight" id="equation-ssmexample5">
<span class="eqno">(72)<a class="headerlink" href="#equation-ssmexample5" title="Link to this equation">#</a></span>\[\mathbf{y}_t = \mathbf{C}_\theta \, \mathbf{x}_t + \mathbf{v}_t\]</div>
<p>The state vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> includes the temperatures <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_e\)</span> calculated by the model, and <span class="math notranslate nohighlight">\(\mathbf{u}=\left[T_o, \Phi_h, \Phi_s\right]\)</span> is the input vector including boundary conditions and excitations. The second equation is the observation equation. It indicates that the measured quantity <span class="math notranslate nohighlight">\(y_t\)</span> may be different from the output of the state equation. In our case, the observed temperature is only the first component of the state vector, and is encumbered with some measurement error <span class="math notranslate nohighlight">\(\mathbf{v}_t\)</span>. In this equation, time is noted as a subscript to indicate that observations come in a discrete sequence.</p>
</section>
</section>
<section id="deterministic-formulation">
<h2>Deterministic formulation<a class="headerlink" href="#deterministic-formulation" title="Link to this heading">#</a></h2>
<p>We first consider the most simple implementation of the model: if the modelling errors <span class="math notranslate nohighlight">\(\{\omega_i\}\)</span> and <span class="math notranslate nohighlight">\(\{\omega_e\}\)</span> are neglected. This is what we call a deterministic formulation, as this hypothesis is equivalent to assuming that the model is absolutely correct in reproducing the behaviour of the house.</p>
<p>Perhaps the easiest way to solve Eq. <a class="reference internal" href="#equation-ssmexample3">(70)</a> for the temperatures is an explicit discretisation scheme: the indoor and envelope temperatures at time <span class="math notranslate nohighlight">\(t+1\)</span> are functions of all variables at time <span class="math notranslate nohighlight">\(t\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ssmexample6">
<span class="eqno">(73)<a class="headerlink" href="#equation-ssmexample6" title="Link to this equation">#</a></span>\[T_i^{(t+1)} = T_i^{(t)} + \frac{\mathrm{d}t}{C_i} \left( \dfrac{1}{R_i}\left(T_e-T_i\right) + \Phi_h + A_i \Phi_s \right)^{(t)} \]</div>
<div class="math notranslate nohighlight" id="equation-ssmexample7">
<span class="eqno">(74)<a class="headerlink" href="#equation-ssmexample7" title="Link to this equation">#</a></span>\[T_e^{(t+1)} = T_e^{(t)} + \frac{\mathrm{d}t}{C_e} \left( \dfrac{1}{R_i}\left(T_i-T_e\right) + \frac{1}{R_o} \left(T_o-T_e\right) + A_e \Phi_s \Phi_s\right)^{(t)}\]</div>
<p>In Python, we define this model in a function that takes the inputs <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> as first argument, and the model parameters as other arguments. This syntax is necessary so that we can call Scipy’s <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> method later. The function returns the indoor temperature, to be compared with the measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;To&#39;</span><span class="p">,</span> <span class="s1">&#39;Qh&#39;</span><span class="p">,</span> <span class="s1">&#39;I_sol&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Function that will calculate the indoor temperature for a given value of R and C</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simpleRC</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Ri</span><span class="p">,</span> <span class="n">Ro</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ce</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">Ae</span><span class="p">):</span>
    
    <span class="n">time</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">to</span>   <span class="o">=</span> <span class="n">inputs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">phi_h</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">phi_s</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
    
    <span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
    <span class="n">te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
    
    <span class="c1"># Initial temperatures</span>
    <span class="n">ti</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">te</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">Ri</span><span class="o">*</span><span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ro</span><span class="o">*</span><span class="n">ti</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Ri</span> <span class="o">+</span> <span class="n">Ro</span><span class="p">)</span>
    
    <span class="c1"># Loop for calculating all temperatures</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
      <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">ti</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">ti</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">Ci</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">te</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ti</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">Ri</span> <span class="o">+</span> <span class="n">phi_h</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ai</span><span class="o">*</span><span class="n">phi_s</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
      <span class="n">te</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">te</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">Ce</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">te</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">Ri</span> <span class="o">+</span> <span class="p">(</span><span class="n">to</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">te</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">Ro</span> <span class="o">+</span> <span class="n">Ae</span><span class="o">*</span><span class="n">phi_s</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
      
    <span class="k">return</span> <span class="n">ti</span>
</pre></div>
</div>
</div>
</div>
<p>We can find the optimal parameters <span class="math notranslate nohighlight">\(\theta=(R_i, R_o, C_i, C_e, A_i, A_e)\)</span> by minimizing the sum of squared residuals between the measured indoor temperature and the output of the function we just defined. This is equivalent to what the <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> method of Scipy does here.</p>
<p>The method requires initial parameter values. They can be picked by running a few simulations first until the predictions are approximately in the right range. This step is not detailed here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">so</span>

<span class="n">p_opt</span><span class="p">,</span> <span class="n">p_cov</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">simpleRC</span><span class="p">,</span>
                            <span class="n">xdata</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
                            <span class="n">ydata</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
                            <span class="n">p0</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mf">1e7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Saving results into a dataframe and displaying it</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ri&#39;</span><span class="p">,</span> <span class="s1">&#39;Ro&#39;</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="s1">&#39;Ce&#39;</span><span class="p">,</span> <span class="s1">&#39;Ai&#39;</span><span class="p">,</span> <span class="s1">&#39;Ae&#39;</span><span class="p">])</span>
<span class="n">res1</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_opt</span>
<span class="n">res1</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">p_cov</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             avg            std
Ri  4.091570e-03       0.000125
Ro  5.038526e-02       0.004552
Ci  5.344581e+06  225321.203258
Ce  1.761891e+07  841478.831398
Ai  1.861247e-01       0.055401
Ae -1.571828e+00       0.096530
</pre></div>
</div>
</div>
</div>
<p>The estimated parameters seem consistent with our expectations. We can compare the profile of measured indoor temperature with the output that the model predicts given the identified optimal parameters.</p>
<figure class="align-center" id="rcexample02">
<a class="reference internal image-reference" href="_images/rcexample02.png"><img alt="_images/rcexample02.png" src="_images/rcexample02.png" style="width: 500px;" />
</a>
</figure>
</section>
<section id="stochastic-formulation">
<h2>Stochastic formulation<a class="headerlink" href="#stochastic-formulation" title="Link to this heading">#</a></h2>
<p>In more realistic applications, the phenomena that impact the energy balance of a building are far more complex than what such a simple model may predict. We extend the RC model structure in order to include effects of solar irradiance, ventilation, several time constants of inertia… But there is a limit to how complex a model can be made, before parameter identification becomes infeasible.</p>
<p>If a model does not fully describe the thermal behaviour of the building, and this discrepancy is not somehow explicitely accounted for, then the parameter estimates and predictions will be biased and unreliable. Stochastic state-space models are a way to account for modelling uncertainties and are now standard practice in the field of building energy performance assessment.</p>
<section id="specification">
<h3>Specification<a class="headerlink" href="#specification" title="Link to this heading">#</a></h3>
<p>The basics of linear state space models has been explained <a class="reference internal" href="statespace_intro.html#linearssm"><span class="std std-ref">here</span></a> and the principle of the Kalman filter <a class="reference internal" href="statespace_intro.html#kalmanfilter"><span class="std std-ref">here</span></a>. In the following block, a class <code class="docutils literal notranslate"><span class="pre">RC</span></code> is defined which implements these equations for any RC model. Any new RC model can then be inherited from this class, by specifying its matrices <span class="math notranslate nohighlight">\(\mathbf{A}_\mathit{rc}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{A}_\mathit{rc}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}_\mathit{rc}\)</span>, and the covariance matrices of the modelling and measurement errors <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{R}\)</span> (see eq. <a class="reference internal" href="#equation-ssmexample4">(71)</a> and <a class="reference internal" href="#equation-ssmexample5">(72)</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">expm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">inv</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RC</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is the generic class for any RC model structure&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">discretize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This method applies the discretisation equations shown in the previous chapter</span>
<span class="sd">        It is only function of the time step size dt</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span>
        <span class="c1"># Discretisation</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">expm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ac</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ac</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bc</span><span class="p">))</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cc</span>
        <span class="c1"># System error covariance matrix (continuous Qc and discrete Q)</span>
        <span class="n">foo</span> <span class="o">=</span> <span class="n">expm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">([[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Qc</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ac</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">T</span><span class="p">]])</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">foo</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">foo</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">])</span>
        <span class="c1"># Measurement error covariance matrix (discrete)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Rc</span> <span class="o">/</span> <span class="n">dt</span>

        <span class="k">return</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This method predicts the indoor temperature.</span>
<span class="sd">        </span>
<span class="sd">        If update=True, the function will apply all steps of the Kalman filter</span>
<span class="sd">        and return the mean state, covariances of innovations and the likelihood</span>
<span class="sd">        </span>
<span class="sd">        If update=False, the function will only predict states and their variance,</span>
<span class="sd">        as if no measurements were available. Use this for forecasting.</span>
<span class="sd">        </span>
<span class="sd">        x_0: initial state vector</span>
<span class="sd">        t: vector of time coordinates</span>
<span class="sd">        u: input vector</span>
<span class="sd">        y: measurement vector (only required if update=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">N_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="c1"># Initialisation of all arrays that will be used in the calculations</span>
        <span class="c1">#  Mean and variance of the states calculated at the prediction step</span>
        <span class="n">x_avg_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">))</span>
        <span class="n">x_var_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">))</span>
        <span class="n">x_avg_predict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_0</span>
        <span class="n">x_var_predict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">)</span>

        <span class="n">x_avg_update</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">))</span>
        <span class="n">x_var_update</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">))</span>
        <span class="n">x_avg_update</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_0</span>
        <span class="n">x_var_update</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_states</span><span class="p">)</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_time</span><span class="p">)</span>  <span class="c1"># prediction errors (innovations)</span>
        <span class="n">Sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_time</span><span class="p">)</span>  <span class="c1"># innovation covariances</span>
        <span class="n">loglike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_time</span><span class="p">)</span> <span class="c1"># log-likelihood to be minimized</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_time</span><span class="p">):</span>

            <span class="c1">#  Matrices of the current time step (depend on the time step size dt)</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

            <span class="c1"># KALMAN 1: Prediction step</span>
            <span class="n">x_avg_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">x_avg_update</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_var_update</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">F</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">Q</span>

            <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                <span class="c1"># KALMAN 2: Residuals and Kalman gain</span>
                <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x_avg_predict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">foo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span>
                <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">foo</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">foo</span><span class="p">)))</span>
                <span class="n">loglike</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                <span class="c1"># KALMAN 3: Update and weight</span>
                <span class="n">x_avg_update</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_avg_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x_avg_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">x_var_update</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x_avg_update</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_avg_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">x_var_update</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_var_predict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># Returns</span>
        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="c1"># If the Kalman update was used, return </span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x_avg_predict</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">Sigma</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">loglike</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x_avg_predict</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">X_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_var_predict</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">X_avg</span><span class="p">,</span> <span class="n">X_var</span>
</pre></div>
</div>
</div>
</div>
<p>The 2-resistor, 2-capacitor model drawn above is then inherited from this <code class="docutils literal notranslate"><span class="pre">RC</span></code> class. Upon definition, it takes its parameters as arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">tite</span><span class="p">(</span><span class="n">RC</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Ri</span><span class="p">,</span> <span class="n">Ro</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ce</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">Ae</span><span class="p">,</span> <span class="n">qi</span><span class="p">,</span> <span class="n">qe</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Model inputs: ambient temperature, heating, solar irradiance&quot;&quot;&quot;</span>

        <span class="c1"># Model parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ri</span> <span class="o">=</span> <span class="n">Ri</span> <span class="c1"># The first resistance (K/W) of the model, on the indoor side</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ro</span> <span class="o">=</span> <span class="n">Ro</span> <span class="c1"># The second resistance (K/W) of the model, on the outdoor side</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span> <span class="o">=</span> <span class="n">Ci</span> <span class="c1"># Heat capacity (J/K) connected to the indoor temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ce</span> <span class="o">=</span> <span class="n">Ce</span> <span class="c1"># Heat capacity (J/K) connected to the envelope temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ai</span> <span class="o">=</span> <span class="n">Ai</span> <span class="c1"># Solar aperture coefficient directed to the indoor temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ae</span> <span class="o">=</span> <span class="n">Ae</span> <span class="c1"># Solar aperture coefficient directed to the envelope temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qi</span> <span class="o">=</span> <span class="n">qi</span> <span class="c1"># Standard deviation of the modelling error on Ti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qe</span> <span class="o">=</span> <span class="n">qe</span> <span class="c1"># Standard deviation of the modelling error on Ti</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>   <span class="c1"># Standard deviation of the measurement error</span>

        <span class="c1"># Number of states</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_states</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># Matrices of the continuous system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ci</span><span class="o">*</span><span class="n">Ri</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ci</span><span class="o">*</span><span class="n">Ri</span><span class="p">)],</span>
                            <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ce</span><span class="o">*</span><span class="n">Ri</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ce</span><span class="o">*</span><span class="n">Ri</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ce</span><span class="o">*</span><span class="n">Ro</span><span class="p">)]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ai</span> <span class="o">/</span> <span class="n">Ci</span><span class="p">],</span>
                            <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">Ce</span><span class="o">*</span><span class="n">Ro</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ae</span><span class="o">/</span><span class="n">Ce</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="c1"># System and measurement error covariance matrices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Qc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="n">qi</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">qe</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">r</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that this model has four additional parameters compared to the deterministic formulation above: the variance of the modelling errors on each state <code class="docutils literal notranslate"><span class="pre">qi</span></code> and <code class="docutils literal notranslate"><span class="pre">qe</span></code>, and the measurement error <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
</section>
<section id="training">
<h3>Training<a class="headerlink" href="#training" title="Link to this heading">#</a></h3>
<p>We now need to find the parameters that will offer the best fit between predictions of the 2R2C model and indoor temperature measurements. We will simply use the <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> method from Scipy again.</p>
<p>In order to facilitate convergence, an initial parameter value is first defined. Then, the optimiser will act on an evaluation function that receives each parameter as argument, and returns the likelihood value. Some parameters are log-transformed in order to allow the search over larger scales.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition of an evaluation function that takes &quot;normalized&quot; values or each parameter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">evaluation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">Ri</span><span class="p">,</span> <span class="n">Ro</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ce</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">Ae</span><span class="p">,</span> <span class="n">qi</span><span class="p">,</span> <span class="n">qe</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">xe0</span><span class="p">):</span>

    <span class="c1"># Reading the dataframe given as argument</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;To&#39;</span><span class="p">,</span> <span class="s1">&#39;Qh&#39;</span><span class="p">,</span> <span class="s1">&#39;I_sol&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Model specification and initial condition</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tite</span><span class="p">(</span><span class="n">Ri</span><span class="p">,</span> <span class="n">Ro</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ce</span><span class="p">,</span> <span class="n">Ai</span><span class="p">,</span> <span class="n">Ae</span><span class="p">,</span> <span class="n">qi</span><span class="p">,</span> <span class="n">qe</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">x_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xe0</span><span class="p">]</span>

    <span class="c1"># Model prediction, without Kalman update</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">prediction</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># We only need the likelihood for the minimize method</span>
    <span class="k">return</span> <span class="n">X</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>

<span class="c1"># Curve fitting happens here. popt and pcov are the mean and covariance of parameter estimates</span>
<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">evaluation</span><span class="p">,</span>
                       <span class="n">xdata</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
                       <span class="n">ydata</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">],</span>
                       <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res1</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span> <span class="p">,</span>
                       <span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">)</span>

<span class="n">res2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ri&#39;</span><span class="p">,</span> <span class="s1">&#39;Ro&#39;</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="s1">&#39;Ce&#39;</span><span class="p">,</span> <span class="s1">&#39;Ai&#39;</span><span class="p">,</span> <span class="s1">&#39;Ae&#39;</span><span class="p">,</span> <span class="s1">&#39;qi&#39;</span><span class="p">,</span> <span class="s1">&#39;qe&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;xe0&#39;</span><span class="p">])</span>
<span class="n">res2</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">popt</span>
<span class="n">res2</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

<span class="nb">print</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              avg            std
Ri   2.949349e-03       0.000095
Ro   1.531773e-02       0.000642
Ci   3.968843e+06  156385.395882
Ce   1.462941e+07  422775.791736
Ai   2.338998e-01       0.036082
Ae  -7.816955e-02       0.098120
qi   1.874407e-05       0.042286
qe   2.770126e-08       0.001204
r    6.869555e-02     154.980254
xe0  2.989136e+01       0.619351
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">Ae</span></code>, the solar gain coefficient on the envelope capacity, has an average value lower than its standard deviation: this parameter is likely not influential on the outcome.</p>
</section>
<section id="diagnostics-and-residuals-analysis">
<h3>Diagnostics and residuals analysis<a class="headerlink" href="#diagnostics-and-residuals-analysis" title="Link to this heading">#</a></h3>
<p>In order to evaluate the agreement between the fitted model and the data, let us first simply view the model output in prediction mode (without Kalman update at every time step).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model specification with the mean of optimised parameters</span>
<span class="n">model_opt</span> <span class="o">=</span> <span class="n">tite</span><span class="p">(</span><span class="o">*</span><span class="n">res2</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Initial states</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;To&#39;</span><span class="p">,</span> <span class="s1">&#39;Qh&#39;</span><span class="p">,</span> <span class="s1">&#39;I_sol&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="s1">&#39;avg&#39;</span><span class="p">][</span><span class="s1">&#39;xe0&#39;</span><span class="p">]</span> <span class="p">]</span>

<span class="c1"># Prediction without Kalman update, to be compared with the data</span>
<span class="n">x_avg</span><span class="p">,</span> <span class="n">x_var</span> <span class="o">=</span> <span class="n">model_opt</span><span class="o">.</span><span class="n">prediction</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="rcexample03">
<a class="reference internal image-reference" href="_images/rcexample03.png"><img alt="_images/rcexample03.png" src="_images/rcexample03.png" style="width: 500px;" />
</a>
</figure>
<p>The model fits the data well. The 95% confidence intervals are relatively narrow, indicating a good confidence in the prediction.</p>
<p>Another important criterion on which to judge the fitted model is the autocorrelation function (ACF) of the one-step ahead prediction residuals. In order to view these residuals, the prediction function should be run with the Kalman updating switched on, so that the states it returns are one-step ahead predictions only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">model_opt</span><span class="o">.</span><span class="n">prediction</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># eps_ are the one-step ahead prediction residuals</span>
<span class="n">eps_</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">X</span>
<span class="c1"># Let&#39;s only take every other value, so that we have time lags of one hour.</span>
<span class="n">eps_</span> <span class="o">=</span> <span class="n">eps_</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Correlation function of two time series. Can be used for the autocorrelation of a single time series</span>
<span class="k">def</span><span class="w"> </span><span class="nf">crosscorrelation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    http://stackoverflow.com/q/14297012/190597</span>
<span class="sd">    http://en.wikipedia.org/wiki/Autocorrelation#Estimation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">-</span><span class="n">u</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="c1"># Autocorrelation of the residuals (only keeping the first 50 lags)</span>
<span class="n">ACF</span> <span class="o">=</span> <span class="n">crosscorrelation</span><span class="p">(</span><span class="n">eps_</span><span class="p">,</span> <span class="n">eps_</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
<span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_5192/3502243263.py:72: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  epsilon[i] = y[i] - np.dot(H, x_avg_predict[i])
/tmp/ipykernel_5192/3502243263.py:74: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  Sigma[i] = foo
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="rcexample04">
<a class="reference internal image-reference" href="_images/rcexample04.png"><img alt="_images/rcexample04.png" src="_images/rcexample04.png" style="width: 500px;" />
</a>
</figure>
<p>The residuals are low, except from one important peak at 24h lag. This suggests that an important influence occuring with a period of 24 hours has been insufficiently accounted for by the model.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="statespace_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Principle of SSMs</p>
      </div>
    </a>
    <a class="right-next"
       href="pysip.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The pySIP library</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study">Case study</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rc-model">RC model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deterministic-formulation">Deterministic formulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-formulation">Stochastic formulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specification">Specification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics-and-residuals-analysis">Diagnostics and residuals analysis</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Simon Rouchier
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>