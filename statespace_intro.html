
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Principle of SSMs &#8212; Building energy probabilistic modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'statespace_intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data" href="data.html" />
    <link rel="prev" title="Hidden Markov models" href="hmm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Building energy probabilistic modelling - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Building energy probabilistic modelling - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Building energy probabilistic modelling
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="background.html">Motivation for probabilistic modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelling.html">Simplified building energy modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">A Bayesian data analysis workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Simple regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="linearregression.html">Linear regression (PyMC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearregression_stan.html">Linear regression (Stan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changepoint.html">Energy signature</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Time series</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="timeseries_intro.html">Time series models</a></li>
<li class="toctree-l1"><a class="reference internal" href="armax.html">ARMAX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="autocorrelated.html">Autocorrelated energy signature</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm.html">Hidden Markov models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">State-space models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Principle of SSMs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/srouchier/buildingenergygeeks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/srouchier/buildingenergygeeks/issues/new?title=Issue%20on%20page%20%2Fstatespace_intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/statespace_intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Principle of SSMs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-state-space-models">Linear state-space models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-kalman-filter">The Kalman filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-state-space-models">Non-linear state-space models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-state-space-models">Switching state-space models</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="principle-of-ssms">
<span id="ssmprinciple"></span><h1>Principle of SSMs<a class="headerlink" href="#principle-of-ssms" title="Link to this heading">#</a></h1>
<p>Unless specified otherwise, the main source for the descriptions of this section is the book of Simo Särkkä: <a class="reference external" href="https://users.aalto.fi/~ssarkka/pub/cup_book_online_20131111.pdf">Bayesian filtering and smoothing</a></p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h2>
<p>State-space models (SSM) are the continuous-state equivalent of hidden Markov models: the sequence of <span class="math notranslate nohighlight">\(T\)</span> output variables <span class="math notranslate nohighlight">\({y_t}\)</span> is generated by a parallel sequence of <span class="math notranslate nohighlight">\(n_x\)</span> latent continuous state variables <span class="math notranslate nohighlight">\(x_t \in \mathbb{R}^{n_x}\)</span>. Since the letter <span class="math notranslate nohighlight">\(x\)</span> is used here to denote the state variable, we denote the explanatory inputs as <span class="math notranslate nohighlight">\(u_t \in \mathbb{R}^{n_u}\)</span>. A Bayesian SSM is fully defined by four distributions: a prior distribution of the parameters <span class="math notranslate nohighlight">\(\theta\)</span>; a prior distribution of the first hidden state <span class="math notranslate nohighlight">\(\mathbf{x}_0\)</span>; a dynamic model which describes the system dynamics and its uncertainties in terms of the transition probability distribution; a measurement model which describes how the measurements depend on the current state:</p>
<div class="math notranslate nohighlight">
\[\theta \sim p(\theta)\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{x}_0 \sim p(\mathbf{x}_0)\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{x}_t \sim p(\mathbf{x}_t | \mathbf{x}_{t-1}, \theta)\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{y}_t \sim p(\mathbf{y}_t | \mathbf{x}_t, \theta)\]</div>
<p>Given the measurements <span class="math notranslate nohighlight">\(\mathbf{y}_{1:T}\)</span>, we are then interested in computing:</p>
<ul>
<li><p>Filtering distributions, i.e. the marginal distribution of each state given the current and previous measurements:</p>
<div class="math notranslate nohighlight">
\[ p(\mathbf{x}_t | \mathbf{y}_{1:t}, \theta), \quad t = 1, \dots ,T \]</div>
</li>
<li><p>Prediction distributions, the marginal distributions of future states:</p>
<div class="math notranslate nohighlight">
\[ p(\mathbf{x}_{t+k} | \mathbf{y}_{1:t}, \theta), \quad t = 1, \dots ,T, \quad k=1,2,\dots \]</div>
</li>
<li><p>Smoothing distributions, the marginal distributions of each state given all measurements:</p>
<div class="math notranslate nohighlight">
\[p(\mathbf{x}_t | \mathbf{y}_{1:T}, \theta), \quad t = 1, \dots ,T \]</div>
</li>
<li><p>Parameter estimation, i.e. the posterior density of parameters given all measurements:</p>
<div class="math notranslate nohighlight">
\[ p(\theta | \mathbf{y}_{1:T}) \]</div>
</li>
<li><p><em>On-line</em> parameter estimation, i.e. the marginal distribution of parameters given the current and previous measurements:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p(\theta | \mathbf{y}_{1:t}), \quad t = 1, \dots ,T \]</div>
<p>Filtering, prediction and smoothing are variations of <em>state estimation</em>. Filtering and smoothing a linear Gaussian state-space model are respectively done with the Kalman filter (KF) and the Rauch-Tung-Striebel smoother (RTSS). These methods are not applicable to non-linear and non-Gaussian models, but other alternatives are: extended Kalman filter (EKF) and unscented Kalman filter (UKF), along with their smoother counterparts (ERTSS and URTSS); sequential Monte Carlo, or particle filters and smoothers; etc.</p>
<p>Parameter estimation is meant here as the computation of <span class="math notranslate nohighlight">\(p(\theta | \mathbf{y}_{1:T})\)</span>, the marginal posterior of <span class="math notranslate nohighlight">\(\theta\)</span> given all measurements. The way to do this is to perform filtering, which produces the likelihood function <span class="math notranslate nohighlight">\(p(\mathbf{y}_{1:T} | \theta)\)</span> as a side product. The Maximum Likelihood estimate of <span class="math notranslate nohighlight">\(\theta\)</span> is then obtainable by numerical maximization of the likelihood, otherwise the full posterior density can be approached by one of the Markov Chain Monte Carlo (MCMC) methods. As opposed to batch estimation, on-line estimation means computing <span class="math notranslate nohighlight">\(p(\theta | \mathbf{y}_{1:t})\)</span> at every time step <span class="math notranslate nohighlight">\(t\)</span>, i.e. the probability distribution of <span class="math notranslate nohighlight">\(\theta\)</span> given the current and previous measurement.</p>
</section>
<section id="linear-state-space-models">
<span id="linearssm"></span><h2>Linear state-space models<a class="headerlink" href="#linear-state-space-models" title="Link to this heading">#</a></h2>
<p>In the linear Gaussian state-space formulation, both the dynamic and the measurement models are linear with respect to the state <span class="math notranslate nohighlight">\(\mathbf{x}_t\)</span> and the inputs <span class="math notranslate nohighlight">\(\mathbf{u}_t\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-lineardiscrete1">
<span class="eqno">(56)<a class="headerlink" href="#equation-lineardiscrete1" title="Link to this equation">#</a></span>\[\mathbf{x}_t = \mathbf{A}_\theta \, \mathbf{x}_{t-1} + \mathbf{B}_\theta \, \mathbf{u}_t + \mathbf{w}_t\]</div>
<div class="math notranslate nohighlight" id="equation-lineardiscrete2">
<span class="eqno">(57)<a class="headerlink" href="#equation-lineardiscrete2" title="Link to this equation">#</a></span>\[\mathbf{y}_t = \mathbf{C}_\theta \, \mathbf{x}_t + \mathbf{D}_\theta \, \mathbf{u}_t + \mathbf{v}_t \]</div>
<p>where the matrices <span class="math notranslate nohighlight">\(\mathbf{A}_\theta\)</span>, <span class="math notranslate nohighlight">\(\mathbf{B}_\theta\)</span>, <span class="math notranslate nohighlight">\(\mathbf{C}_\theta\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D}_\theta\)</span> have coefficients as functions of <span class="math notranslate nohighlight">\(\theta\)</span> and are not necessarily time-invariant. <span class="math notranslate nohighlight">\(\mathbf{w}_t \sim N\left(0, \mathbf{Q}\right)\)</span> is the process noise and <span class="math notranslate nohighlight">\(\mathbf{v}_t \sim N\left(0, \mathbf{R}\right)\)</span> is the measurement noise.</p>
<p>As a practical example of linear state-space models, the simplified resistor-capacitor (RC) model structures are a popular choice for either parameter estimation or system identification. When written as a set of stochastic differential equations, they allow accounting for modelling approximations <span id="id1">[<a class="reference internal" href="references.html#id28" title="Henrik Madsen and Jan Holst. Estimation of continuous-time models for the heat dynamics of a building. Energy and buildings, 22(1):67–79, 1995.">Madsen and Holst, 1995</a>]</span> and offer a more reproducible parameter estimation than deterministic models that overlook modelling errors <span id="id2">[<a class="reference internal" href="references.html#id29" title="Simon Rouchier, Mickaël Rabouille, and Pierre Oberlé. Calibration of simplified building energy models for parameter estimation and forecasting: stochastic versus deterministic modelling. Building and Environment, 134:181–190, 2018.">Rouchier <em>et al.</em>, 2018</a>]</span>. These models will be used in the next chapter for the estimation of thermal properties of building envelopes.</p>
<figure class="align-center" id="rcmodel">
<a class="reference internal image-reference" href="_images/rcmodel.png"><img alt="_images/rcmodel.png" src="_images/rcmodel.png" style="width: 450px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Second order RC model</span><a class="headerlink" href="#rcmodel" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Consider the example of a simple building represented by a 2-resistor, 2-capacitor model structure (2R2C) as shown here. The equations of this model are:</p>
<div class="math notranslate nohighlight">
\[C_i \, \mathrm{d} T_i = \dfrac{1}{R_i}\left(T_e-T_i\right)\mathrm{d}t + \Phi_h \, \mathrm{d}t + A_i \Phi_s \mathrm{d}t + \sigma_i \,\mathrm{d}\omega_i\]</div>
<div class="math notranslate nohighlight">
\[C_e \, \mathrm{d} T_e = \dfrac{1}{R_i}\left(T_i-T_e\right)\mathrm{d}t + \frac{1}{R_o}\left(T_o-T_e\right)\mathrm{d}t + A_e \Phi_s \mathrm{d}t + \sigma_e \, \mathrm{d}\omega_e \]</div>
<p>where <span class="math notranslate nohighlight">\(T_i\)</span>, <span class="math notranslate nohighlight">\(T_e\)</span> and <span class="math notranslate nohighlight">\(T_o\)</span> are the indoor, envelope and outdoor temperatures. The envelope temperature is associated with the thermal mass of the opaque surfaces, and does not represent a specific coordinate within the envelope. The model has two states <span class="math notranslate nohighlight">\(T_e\)</span> (unobserved) and <span class="math notranslate nohighlight">\(T_i\)</span> (observed); <span class="math notranslate nohighlight">\(\Phi_h\)</span> (W) is the indoor heating power; <span class="math notranslate nohighlight">\(\Phi_s\)</span> (W/m<span class="math notranslate nohighlight">\(^2\)</span>) is the global horizontal solar irradiance. <span class="math notranslate nohighlight">\(R_i\)</span> (K/W) is the thermal resistance between the indoor air temperature and the envelope, <span class="math notranslate nohighlight">\(R_e\)</span> the resistance between the envelope and the ambient air. <span class="math notranslate nohighlight">\(C_i\)</span> and <span class="math notranslate nohighlight">\(C_e\)</span> (J/K) are the heat capacitances of the interior and the envelope, respectively, and <span class="math notranslate nohighlight">\(A_i\)</span> and <span class="math notranslate nohighlight">\(A_e\)</span> (m<span class="math notranslate nohighlight">\(^2\)</span>) are their solar gain coefficients. <span class="math notranslate nohighlight">\(\{\omega_i\}\)</span> and <span class="math notranslate nohighlight">\(\{\omega_e\}\)</span> are standard Wiener processes and <span class="math notranslate nohighlight">\(\sigma_i^2\)</span> are <span class="math notranslate nohighlight">\(\sigma_e^2\)</span> are their variances. This process noise is a way to account for modelling approximations, unrecognized inputs or noise-corrupted input measurements.</p>
<p>The state-space equations can be written in matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{d} \begin{bmatrix} T_i \\ T_e \end{bmatrix} = \begin{pmatrix} -\frac{1}{R_i \, C_i} &amp; \frac{1}{R_i \, C_i} \\ \frac{1}{R_i \, C_e} &amp; -\frac{1}{R_i \, C_e}-\frac{1}{R_e \, C_e}\end{pmatrix} \begin{bmatrix} T_i \\ T_e \end{bmatrix}\, \mathrm{d}t + \begin{pmatrix} 0 &amp; \frac{1}{C_i} &amp; \frac{A_i}{C_i} \\ \frac{1}{R_e \, C_e} &amp; 0 &amp; \frac{A_e}{C_e} \end{pmatrix} \begin{bmatrix} T_o \\ \Phi_h \\ \Phi_s \end{bmatrix} \, \mathrm{d}t + \mathbf{\sigma} \, \mathrm{d}\omega\end{split}\]</div>
<p>which is the dynamic model of the following stochastic state-space model, written in continuous-discrete form:</p>
<div class="math notranslate nohighlight">
\[\mathrm{d}\mathbf{x}(t) = \mathbf{A}_\mathit{rc} \, \mathbf{x}(t) \, \mathrm{d}t + \mathbf{B}_\mathit{rc} \, \mathbf{u}(t)\,\mathrm{d}t + \mathbf{\sigma}_\theta \mathrm{d}\omega\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{y}_t = \mathbf{C}_\theta \, \mathbf{x}_t + \mathbf{v}_t\]</div>
<p>The state vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> includes the temperatures <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_e\)</span> calculated by the model, and <span class="math notranslate nohighlight">\(\mathbf{u}=\left[T_o, \Phi_h, \Phi_s\right]\)</span> is the input vector including boundary conditions and excitations. The second equation is the observation equation. It indicates that the measured quantity <span class="math notranslate nohighlight">\(y_t\)</span> may be different from the output of the state equation. In our case, the observed temperature is only the first component of the state vector, and is encumbered with some measurement error <span class="math notranslate nohighlight">\(\mathbf{v}_t\)</span>. In this equation, time is noted as a subscript to indicate that observations come in a discrete sequence.</p>
<p>This model must be discretized in order to specify its evolution between discrete time coordinates. Supposing a sample interval length <span class="math notranslate nohighlight">\(\Delta t\)</span> and assume that the inputs <span class="math notranslate nohighlight">\(\mathbf{u}(t)\)</span> are constant during each interval. Eq. &#64;ref(eq:statespace4) and &#64;ref(eq:statespace5) can be discretized into the system of Eq. &#64;ref(eq:lineardiscrete1) and &#64;ref(eq:lineardiscrete2) through the following discretization equations:</p>
<div class="math notranslate nohighlight" id="equation-discretization1">
<span class="eqno">(58)<a class="headerlink" href="#equation-discretization1" title="Link to this equation">#</a></span>\[\mathbf{A}_\theta = \mathrm{exp}\left( \mathbf{A}_\mathit{rc} \, \Delta t  \right) \]</div>
<div class="math notranslate nohighlight" id="equation-discretization2">
<span class="eqno">(59)<a class="headerlink" href="#equation-discretization2" title="Link to this equation">#</a></span>\[\mathbf{B}_\theta = \mathbf{A}_\mathit{rc}^{-1} \, \left(\mathbf{A}_\theta-\mathbf{I}\right) \, \mathbf{B}_\mathit{rc}\]</div>
<div class="math notranslate nohighlight" id="equation-discretization4">
<span class="eqno">(60)<a class="headerlink" href="#equation-discretization4" title="Link to this equation">#</a></span>\[\mathbf{Q} = \int_0^{\Delta t} \mathrm{exp}\left( \mathbf{A}_\mathit{rc} \, \Delta t  \right) \, \mathbf{\sigma}_\theta \, \mathrm{exp}\left( \mathbf{A}_\mathit{rc}^T \, \Delta t  \right) \mathrm{d}t\]</div>
<p>The Kalman filter is the typical method for computing the marginal distribution of each state <span class="math notranslate nohighlight">\(p(\mathbf{x}_t | \mathbf{y}_{1:t}, \theta)\)</span> and the likelihood function <span class="math notranslate nohighlight">\(p(\mathbf{y}_{1:t}| \theta)\)</span> from which <span class="math notranslate nohighlight">\(\theta\)</span> can be estimated.</p>
</section>
<section id="the-kalman-filter">
<span id="kalmanfilter"></span><h2>The Kalman filter<a class="headerlink" href="#the-kalman-filter" title="Link to this heading">#</a></h2>
<p>Given a state transition probability <span class="math notranslate nohighlight">\(p\left( \mathbf{x}_{t} | \theta, \mathbf{x}_{t-1}, \mathbf{u}_{t} \right)\)</span> (Eq. <a class="reference internal" href="#equation-lineardiscrete1">(56)</a>) and an observation probability <span class="math notranslate nohighlight">\(p\left( \mathbf{y}_{t} | \mathbf{x}_{t}\right)\)</span> (Eq. <a class="reference internal" href="#equation-lineardiscrete2">(57)</a>), a Kalman filter produces <span class="math notranslate nohighlight">\(p\left(\mathbf{x}_t|\mathbf{y}_{1:T}, \theta \right)\)</span>, the probability distribution function of each state <span class="math notranslate nohighlight">\(\mathbf{x}_t\)</span> given measurements and parameter values, and the marginal likelihood function <span class="math notranslate nohighlight">\(L_y(\theta)=p\left(\mathbf{y}_{1:T} | \theta \right)\)</span>.</p>
<p>Filtering produces <span class="math notranslate nohighlight">\(p\left(\mathbf{x}_t|\mathbf{y}_{1:N}, \theta \right)\)</span>, the probability distribution function of each state <span class="math notranslate nohighlight">\(\mathbf{x}_t\)</span> given measurements and parameter values. In the following, definitions adapted from the book of Shumway et al <span id="id3">[<a class="reference internal" href="references.html#id22" title="Robert H Shumway, David S Stoffer, and David S Stoffer. Time series analysis and its applications. Volume 3. Springer, 2000.">Shumway <em>et al.</em>, 2000</a>]</span> are used: <span class="math notranslate nohighlight">\(\mathbf{x}_{t|s}\)</span> is the expected state at time <span class="math notranslate nohighlight">\(t\)</span> given observations up to time <span class="math notranslate nohighlight">\(s\)</span>. <span class="math notranslate nohighlight">\(\mathbf{P}_{t|s}\)</span> is the variance of the state <span class="math notranslate nohighlight">\(\mathbf{x}_{t}\)</span>, i.e. the mean-squared error.</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}_{t|s} = \mathrm{E}\left(\mathbf{x}_t|\mathbf{y}_{1:s}, \theta \right) \]</div>
<div class="math notranslate nohighlight">
\[\mathbf{P}_{t|s} = \mathrm{Var}\left(\mathbf{x}_t|\mathbf{y}_{1:s, \theta}\right)= \mathrm{E}\left[(\mathbf{x}_t-\mathbf{x}_{t|s})(\mathbf{x}_t-\mathbf{x}_{t|s})^T|\mathbf{y}_{1:s}, \theta \right]\]</div>
<figure class="align-center" id="kalman">
<a class="reference internal image-reference" href="_images/kalman.png"><img alt="_images/kalman.png" src="_images/kalman.png" style="width: 350px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Schematic view of one iteration of the Kalman filter</span><a class="headerlink" href="#kalman" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The Kalman filter algorithm is described here and illustrated by Fig. <a class="reference internal" href="#kalman"><span class="std std-ref">Schematic view of one iteration of the Kalman filter</span></a>:</p>
<ul class="simple">
<li><p>Set the initial states <span class="math notranslate nohighlight">\(\mathbf{x}_{0|0}\)</span> and their covariance <span class="math notranslate nohighlight">\(\mathbf{P}_{0|0}\)</span></p></li>
<li><p>for <span class="math notranslate nohighlight">\(t=1...T\)</span>:</p>
<ol class="arabic simple">
<li><p><strong>Prediction step</strong>: given the previous state <span class="math notranslate nohighlight">\(\mathbf{x}_{t|t}\)</span> and its covariance <span class="math notranslate nohighlight">\(\mathbf{P}_{t|t}\)</span>, the model estimates the one-step ahead prediction.</p></li>
</ol>
</li>
</ul>
<div class="math notranslate nohighlight">
\[\mathbf{x}_{t+1|t} = \mathbf{A}_\theta \, \mathbf{x}_{t|t} + \mathbf{B}_\theta \, \mathbf{u}_{t+1}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{P}_{t+1|t} = \mathbf{A}_\theta \, \mathbf{P}_{t|t} \, \mathbf{A}_\theta^T + \mathbf{Q}\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Innovations</strong> (prediction error) <span class="math notranslate nohighlight">\(\varepsilon_{t+1}\)</span> and their covariances <span class="math notranslate nohighlight">\(\Sigma_{t+1}\)</span> are then calculated, along with the Kalman gain <span class="math notranslate nohighlight">\(\mathbf{K}_{t+1}\)</span>, by comparing <strong>measurements</strong> <span class="math notranslate nohighlight">\(\mathbf{y}_{t+1}\)</span> with the one-step ahead prediction <span class="math notranslate nohighlight">\(\mathbf{x}_{t+1|t}\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\varepsilon_{t+1} = \mathbf{y}_{t+1} - \mathbf{C}_\theta \, \mathbf{x}_{t+1|t}\]</div>
<div class="math notranslate nohighlight">
\[\Sigma_{t+1} = \mathbf{C}_\theta \, \mathbf{P}_{t+1|t} \, \mathbf{C}_\theta^T + \mathbf{R}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{K}_{t+1} = \mathbf{P}_{t+1|t} \, \mathbf{C}_\theta^T \, \Sigma_{t+1}^{-1}\]</div>
<ol class="arabic simple" start="3">
<li><p><strong>Updating step</strong>: the new states at time <span class="math notranslate nohighlight">\(t+1\)</span> are updated, as a compromise between the one-step ahead prediction and the measurement.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\mathbf{x}_{t+1|t+1} = \mathbf{x}_{t+1|t} + \mathbf{K}_{t+1} \, \mathbf{\varepsilon}_{t+1}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{P}_{t+1|t+1} = \left( \mathbf{I}- \mathbf{K}_{t+1} \, \mathbf{C}_\theta \right) \, \mathbf{P}_{t+1|t}\]</div>
<ul class="simple">
<li><p>The total (negative) log-likelihood can be calculated up to a normalizing constant:
\begin{equation}</p></li>
</ul>
<div class="math notranslate nohighlight">
\[-\ln L_y(\theta) = \frac{1}{2} \sum_{t=1}^{T} \ln \left|\Sigma_t(\theta)\right| + \frac{1}{2} \sum_{t=1}^{T} \varepsilon_t(\theta)^T \, \Sigma_t(\theta)^{-1} \, \varepsilon_t(\theta)\]</div>
<p>Roughly speaking, the Kalman filter applies Bayes’ rule at each time step: the updated state <span class="math notranslate nohighlight">\(p(\mathbf{x}_t|\mathbf{y}_{1:t})=N(\mathbf{x}_{t|t}, \mathbf{P}_{t|t})\)</span> is a posterior distribution, obtained from a compromise between a prior output of the model <span class="math notranslate nohighlight">\(p(\mathbf{x}_t|\mathbf{y}_{1:t-1})=N(\mathbf{x}_{t|t-1}, \mathbf{P}_{t|t-1})\)</span> and the evidence brought by measurements <span class="math notranslate nohighlight">\(\mathbf{y}_t\)</span>. Their relative weight is expressed by the Kalman gain <span class="math notranslate nohighlight">\(\mathbf{K}_t\)</span> that measures the relative confidence we put in both the model and the measurements.</p>
</section>
<section id="non-linear-state-space-models">
<h2>Non-linear state-space models<a class="headerlink" href="#non-linear-state-space-models" title="Link to this heading">#</a></h2>
<p>State-space models are not necessarily linear or Gaussian. In a more generic situation, the system of equations &#64;ref(eq:ssm) can take the form:</p>
<div class="math notranslate nohighlight" id="equation-nonlineardiscrete1">
<span class="eqno">(61)<a class="headerlink" href="#equation-nonlineardiscrete1" title="Link to this equation">#</a></span>\[\mathbf{x}_t = F(\mathbf{x}_{t-1}, \mathbf{u}_t, \mathbf{w}_t) \]</div>
<div class="math notranslate nohighlight" id="equation-nonlineardiscrete2">
<span class="eqno">(62)<a class="headerlink" href="#equation-nonlineardiscrete2" title="Link to this equation">#</a></span>\[\mathbf{y}_t = G(\mathbf{x}_t, \mathbf{u}_t, \mathbf{v}_t) \]</div>
<p>The most common extensions of the Kalman filter to non-linear systems are the extended Kalman filter (EKF) and unscented Kalman filter (UKF). The EKF approximates the non-linear and non-Gaussian measurement and dynamic models by linearization at the nominal solution. The unscented Kalman filter (UKF) approximates the propagation of densities through the non-linearities of measurement and noise processes using the unscented transform. They are both Gaussian approximations.</p>
<p>Non-linearity in a building energy state-space model can arise in different situations:</p>
<ul class="simple">
<li><p>The states can include not only the temperatures simulated by an RC model. By using fictitious process equations to augment the state vector with model parameters, it is possible to perform on-line joint state-parameter estimation.</p></li>
<li><p>To encode time-varying uncertainty in some of the model inputs: states can be augmented with additional state variables describing these varying unknown parameters.</p></li>
</ul>
<p>For non-linear non-Gaussian state-space models, particle filters, or sequential Monte Carlo (SMC) methods, are now a popular alternative to the EKF because of their suitability for parallel implementation and for on-line inference <span id="id4">[<a class="reference internal" href="references.html#id30" title="Olivier Cappé, Simon J Godsill, and Eric Moulines. An overview of existing methods and recent advances in sequential monte carlo. Proceedings of the IEEE, 95(5):899–924, 2007.">Cappé <em>et al.</em>, 2007</a>]</span>. SMC filters and smoothers represent the posterior distribution of states as a weighted set of Monte Carlo samples. They are applicable to joint state-parameter estimation and have already been applied to the characterization of building envelope properties <span id="id5">[<a class="reference internal" href="references.html#id32" title="Simon Rouchier, Maria José Jiménez, and Sergio Castaño. Sequential monte carlo for on-line parameter estimation of a lumped building energy model. Energy and Buildings, 187:86–94, 2019.">Rouchier <em>et al.</em>, 2019</a>]</span>.</p>
<p>In a non-Bayesian framework, particle methods can approximate the likelihood function which may then be maximized for an off-line or on-line ML estimation of parameters <span id="id6">[<a class="reference internal" href="references.html#id33" title="Nikolas Kantas, Arnaud Doucet, Sumeetpal S Singh, Jan Maciejowski, Nicolas Chopin, and others. On particle methods for parameter estimation in state-space models. Statistical science, 30(3):328–351, 2015.">Kantas <em>et al.</em>, 2015</a>]</span>. In Bayesian joint state-parameter estimation, the target distribution <span class="math notranslate nohighlight">\(p(\theta, x_{1:T} | y_{1:T})\)</span> can be approached in several ways: Particle MCMC methods <span id="id7">[<a class="reference internal" href="references.html#id31" title="Christophe Andrieu, Arnaud Doucet, and Roman Holenstein. Particle markov chain monte carlo methods. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 72(3):269–342, 2010.">Andrieu <em>et al.</em>, 2010</a>]</span> sample from <span class="math notranslate nohighlight">\(\theta\)</span> with a MCMC method, within which particle filters are called to approximate the marginal state distributions; the SMC<span class="math notranslate nohighlight">\(^2\)</span> algorithm <span id="id8">[<a class="reference internal" href="references.html#id34" title="Nicolas Chopin, Pierre E Jacob, and Omiros Papaspiliopoulos. Smc2: an efficient algorithm for sequential analysis of state space models. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 75(3):397–426, 2013.">Chopin <em>et al.</em>, 2013</a>]</span> couples a SMC algorithm in the <span class="math notranslate nohighlight">\(\theta\)</span>-dimension, which propagates and resamples many particle filters in the <span class="math notranslate nohighlight">\(x\)</span>-dimension.</p>
</section>
<section id="switching-state-space-models">
<h2>Switching state-space models<a class="headerlink" href="#switching-state-space-models" title="Link to this heading">#</a></h2>
<p>The last form of statistical model we will mention here are the state-space models with regime switching, or switching state-space models (SSSM), or switching dynamical systems. They are state-space models containing both categorical and continuous hidden variables, and thus a sort of coalition between hidden Markov models and state-space models.</p>
<figure class="align-center" id="tikzsdm">
<a class="reference internal image-reference" href="_images/tikz_sdm.png"><img alt="_images/tikz_sdm.png" src="_images/tikz_sdm.png" style="width: 270px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Switching dynamic model</span><a class="headerlink" href="#tikzsdm" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>One of the forms of SSSMs is shown here, where the continuous state variable <span class="math notranslate nohighlight">\(X\)</span> is conditioned on a categorical latent variable <span class="math notranslate nohighlight">\(S\)</span> denoted the <em>switch</em>. Like in an HMM or MSM, the switch refers to one of several possible regimes the system can be in. The solutions of such models with a fixed number of modes of operation can be approximated by several methods</p>
<ul class="simple">
<li><p>Generalized pseudo-Bayesian methods, and the interacting multiple model (IMM) algorithm <span id="id9">[<a class="reference internal" href="references.html#id36" title="Henk AP Blom and Yaakov Bar-Shalom. The interacting multiple model algorithm for systems with markovian switching coefficients. IEEE transactions on Automatic Control, 33(8):780–783, 1988.">Blom and Bar-Shalom, 1988</a>]</span>, based on forming a mixture of Kalman filters;</p></li>
<li><p>Expectation propagation <span id="id10">[<a class="reference internal" href="references.html#id35" title="Onno Zoeter and T Heskes. Expectation propagation and generalised ep methods for inference in switching linear dynamical systems. Cambridge University Press, 2011.">Zoeter and Heskes, 2011</a>]</span>;</p></li>
<li><p>Rao-Blackwellised particle filters <span id="id11">[<a class="reference internal" href="references.html#id37" title="Arnaud Doucet, Nando de Freitas, Kevin Murphy, and Stuart Russell. Rao-blackwellised particle filtering for dynamic bayesian networks. In Uncertainty in Artificial Intelligence (UAI), 176–183. San Francisco, CA, 2000.">Doucet <em>et al.</em>, 2000</a>]</span> use closed form integration (Kalman filters) for some of the state variables and Monte Carlo integration for others <span id="id12">[<a class="reference internal" href="references.html#id38" title="Simo Särkkä. Bayesian filtering and smoothing. Cambridge University Press, 2013.">Särkkä, 2013</a>]</span>.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="hmm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hidden Markov models</p>
      </div>
    </a>
    <a class="right-next"
       href="data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-state-space-models">Linear state-space models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-kalman-filter">The Kalman filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-state-space-models">Non-linear state-space models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-state-space-models">Switching state-space models</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Simon Rouchier
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>